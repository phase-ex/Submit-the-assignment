# 数据分析与预测项目说明文档

## 目录
1. 项目简介
2. 数据预处理
3. 数据分析
4. 数据可视化
5. 预测模型
6. 结果评估
7. 未来预测
8. 结论

## 1. 项目简介
本项目旨在分析2023年的销售数据，并基于历史数据进行未来的销量和销售额预测。我们使用了Python的Pandas、NumPy、Matplotlib、Seaborn和Scikit-learn库来处理数据、进行分析和构建预测模型。

## 2. 数据预处理
### 2.1 导入库
我们导入了必要的库，包括Pandas用于数据处理，NumPy用于数值计算，Matplotlib和Seaborn用于数据可视化，Scikit-learn用于构建和评估预测模型。

### 2.2 设置中文字体
为了确保图表中的中文能够正确显示，我们设置了Matplotlib的字体参数。

### 2.3 读取数据
从CSV文件中读取合并后的数据，并确保日期列被正确解析为datetime类型。

### 2.4 检查列名
检查数据框的列名以确保数据的完整性和正确性。

### 2.5 过滤2023年的数据
过滤出2023年的数据以进行后续分析。

## 3. 数据分析
### 3.1 检查唯一值
检查`ywlx_code`列的唯一值，以了解不同的业务类型。

### 3.2 过滤配送和自提记录
使用字符串匹配来过滤包含“配送”或“自提”的记录，并分析自提与配送的变化。

### 3.3 计算总销量和总销售额
按货品类型计算2023年的总销量（吨）和总销售额（元）。

### 3.4 按月统计
按月统计销量和销售额，并计算平均单价。

### 3.5 客户需求分析
分析客户的总需求量和总销售额，并计算客户贡献度。

### 3.6 销售经理贡献分析
分析销售经理的总销量和总销售额，并计算销售经理的贡献度。

## 4. 数据可视化
### 4.1 自提与配送的变化趋势图
绘制2023年月度自提与配送的销量和销售额变化趋势图。

### 4.2 月度销量和销售额的折线图
绘制2023年月度销量和销售额的折线图。

### 4.3 客户需求量和销售额的饼状图
绘制2023年前15名客户的需求量和销售额的饼状图。

### 4.4 销售经理销量和销售额的饼状图
绘制2023年销售经理的销量和销售额的饼状图。

## 5. 预测模型
### 5.1 准备时间序列数据
使用所有数据准备时间序列数据，并将日期转换为天数。

### 5.2 拆分训练集和测试集
将数据拆分为训练集和测试集，以便进行模型训练和评估。

### 5.3 建立线性回归模型
建立线性回归模型并进行训练。

### 5.4 预测
使用训练好的模型进行销量和销售额的预测，并确保预测值不为负。

## 6. 结果评估
### 6.1 评估模型
使用均方误差（MSE）和R²评分来评估模型的性能。

## 7. 未来预测
### 7.1 预测未来数据
预测未来的数据到2025年，并确保预测值不为负。

### 7.2 合并实际和预测数据
合并实际数据和预测数据，并绘制预测的折线图。

### 7.3 预测年度总销量和总销售额
预测年度总销量和总销售额，并计算增长率。

## 8. 结论
### 8.1 分析前15位客户的常用配送方式
分析前15位客户的常用配送方式，并总结项目的主要发现和结论。

通过本项目，我们不仅对2023年的销售数据进行了详细的分析，还基于历史数据构建了预测模型，为未来的业务决策提供了有力的支持。